# ğŸš€ Fly.io Deployment Guide

## Community Support System - Production Deployment

### ğŸ¯ What You Get

- **Native PostgreSQL Database** (3GB free storage)
- **All 133+ API endpoints** working
- **Complete database schema** with relationships
- **Automatic table creation** and sample data
- **Health monitoring** and auto-scaling
- **HTTPS enabled** by default

---

## ğŸ“‹ Prerequisites

1. **Install Fly.io CLI:**
   ```bash
   curl -L https://fly.io/install.sh | sh
   ```

2. **Create Fly.io Account:**
   - Visit [fly.io](https://fly.io)
   - Sign up (free tier included)

---

## ğŸš€ One-Click Deployment

```bash
./deploy-to-fly.sh
```

This script will:
1. âœ… Create PostgreSQL database (3GB)
2. âœ… Set up the application
3. âœ… Configure environment variables
4. âœ… Attach database to app
5. âœ… Deploy and start the service

---

## ğŸŒ Access Your Application

After deployment, your app will be available at:

| Service | URL | Description |
|---------|-----|-------------|
| **Main App** | `https://community-support-system.fly.dev` | API Base URL |
| **Health Check** | `https://community-support-system.fly.dev/actuator/health` | System Status |
| **API Documentation** | `https://community-support-system.fly.dev/swagger-ui.html` | Interactive API Docs |
| **Sample Endpoint** | `https://community-support-system.fly.dev/api/users` | Test API |

---

## ğŸ—„ï¸ Database Features

### Automatic Setup
- **PostgreSQL 16+** with 3GB storage
- **All tables created** automatically
- **Sample data loaded** (30 locations, 46 skills, admin user)
- **Relationships established** (1:1, 1:N, N:1, M:N)

### Database Schema
- ğŸ›ï¸ **locations** (30 Rwandan districts)
- ğŸ‘¥ **users** (Citizens & Volunteers)
- ğŸ“ **requests** (Help requests)
- ğŸ¤ **assignments** (Volunteer assignments)
- ğŸ”” **notifications** (System alerts)
- ğŸ¯ **skills** (46 predefined skills)
- ğŸ”— **user_skills** (Many-to-many junction)
- âš™ï¸ **user_settings** (User preferences)

---

## ğŸ”§ Environment Variables

The following are automatically configured:

```bash
SPRING_PROFILES_ACTIVE=fly
DATABASE_URL=[Auto-generated by Fly.io]
JWT_SECRET=5f566298b0ba4f8e38c1ff7c6e0844a1
JWT_EXPIRATION=86400000
CORS_ALLOWED_ORIGINS=https://community-support-system.vercel.app
FRONTEND_URL=https://community-support-system.vercel.app
SENDGRID_ENABLED=false
```

---

## ğŸ“Š API Endpoints (133+ Total)

### Core Endpoints
- **ğŸ‘¥ Users**: 25 endpoints (CRUD, search, skills management)
- **ğŸ›ï¸ Locations**: 11 endpoints (Rwanda administrative data)
- **ğŸ“ Requests**: 15 endpoints (Help requests management)
- **ğŸ¤ Assignments**: 12 endpoints (Volunteer assignments)
- **ğŸ”” Notifications**: 14 endpoints (System notifications)
- **ğŸ¯ Skills**: 13 endpoints (Skills management)
- **âš™ï¸ Settings**: 4 endpoints (User preferences)
- **ğŸ‡·ğŸ‡¼ Rwanda Locations**: 5 endpoints (External API integration)

### Sample API Calls
```bash
# Get all users
curl https://community-support-system.fly.dev/api/users

# Get health status
curl https://community-support-system.fly.dev/actuator/health

# Get all locations
curl https://community-support-system.fly.dev/api/locations
```

---

## ğŸ” Monitoring & Management

### Fly.io Commands
```bash
# Check app status
flyctl status

# View logs
flyctl logs

# Scale app
flyctl scale count 2

# Connect to database
flyctl postgres connect -a community-support-db

# SSH into app
flyctl ssh console
```

### Health Monitoring
- **Automatic health checks** every 15 seconds
- **Auto-restart** on failure
- **Graceful shutdown** handling

---

## ğŸ‰ Success Indicators

After deployment, verify these work:

1. âœ… **Health Check**: Returns `{"status":"UP"}`
2. âœ… **API Documentation**: Swagger UI loads
3. âœ… **Database**: Sample data visible in API responses
4. âœ… **CORS**: Frontend can connect
5. âœ… **All Endpoints**: 133+ endpoints responding

---

## ğŸ†˜ Troubleshooting

### Common Issues
- **Build fails**: Check Java 21 compatibility
- **Database connection**: Verify DATABASE_URL is set
- **Health check fails**: Check port 8080 binding

### Debug Commands
```bash
# View environment variables
flyctl secrets list

# Check database connection
flyctl postgres connect -a community-support-db

# View application logs
flyctl logs --app community-support-system
```

---

## ğŸ’° Cost Breakdown

- **Application**: Free tier (shared CPU, 256MB RAM)
- **PostgreSQL**: Free tier (3GB storage)
- **Bandwidth**: 160GB/month free
- **Total**: **$0/month** for development/testing

---

Your Community Support System is now **production-ready** on Fly.io! ğŸ¯